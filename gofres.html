<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ§‡ Construye tu Gofre</title>
<style>
body { font-family:'Segoe UI',sans-serif; background:#fcefe6; text-align:center; padding:20px; }
.card { background:white; max-width:450px; margin:auto; padding:20px; border-radius:15px; box-shadow:0 8px 20px rgba(0,0,0,.15);}
h2 { color:#d2691e; }
.tower { display:flex; flex-direction:column-reverse; align-items:center; min-height:220px; border:3px dashed #ddd; border-radius:10px; padding:10px; margin:15px 0; }
.layer { width:80%; height:40px; margin:4px 0; border-radius:6px; line-height:40px; color:white; font-weight:bold; text-align:center; transition:0.3s; }
button { padding:10px 15px; margin:5px; border:none; border-radius:8px; cursor:pointer; font-weight:bold; }
.btn-main { background:#4CAF50; color:white; width:100%; margin-top:15px; font-size:1.1em; }
</style>
</head>
<body>

<div class="card">
<h2>ðŸ§‡ Construye tu Gofre</h2>
<div class="tower" id="tower"></div>

<div class="controls">
<button onclick="add('Gofre')" style="background:#d2691e;">Gofre</button>
<button onclick="add('Nocilla Blanca')" style="background:#fffacd; color:#333;">Nocilla Blanca</button>
<button onclick="add('Nocilla Normal')" style="background:#4E342E;">Nocilla Normal</button>
<button onclick="add('KitKat')" style="background:#C62828;">KitKat</button>
<button onclick="add('Oreo')" style="background:#263238;">Oreo</button>
<button onclick="remove()" style="background:#f44336; color:white;">Quitar</button>
</div>

<button class="btn-main" onclick="pedir()">ðŸ§¾ PEDIR</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyCUtGv322RpaHehADB7BqHEkOjMFV2cEoc",
  authDomain: "gofres-tortitas.firebaseapp.com",
  projectId: "gofres-tortitas",
  storageBucket: "gofres-tortitas.firebasestorage.app",
  messagingSenderId: "840337514642",
  appId: "1:840337514642:web:3986826058b711131e464b"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const tower=document.getElementById("tower");
let stack=[];

const colors = {
  "Gofre":"#d2691e","Nocilla Blanca":"#FFF3B0","Nocilla Normal":"#4E342E","KitKat":"#C62828","Oreo":"#263238"
};

function createLayer(nombre){
  const d=document.createElement("div");
  d.className="layer";
  d.textContent=nombre;
  d.style.backgroundColor = colors[nombre];
  return d;
}

function add(nombre){
  const gofresCount = stack.filter(i=>i==="Gofre").length;
  if(nombre==="Gofre" && gofresCount>=1) return alert("Solo un gofre permitido");
  if(stack.length>=3) return alert("MÃ¡x 3 capas");
  stack.push(nombre);
  tower.appendChild(createLayer(nombre));
}

function remove(){ 
  if(stack.length){ 
    stack.pop(); 
    tower.removeChild(tower.lastChild); 
  }
}

function pedir(){
  if(stack.length===0) return alert("Agrega al menos una capa");
  const nombre = prompt("Â¿Tu nombre?");
  if(!nombre) return;
  db.collection("pedidos").add({
    nombre,
    tipo:"Gofre",
    capas:stack,
    estado:"RECIBIDO",
    aviso:false,
    fecha:Date.now()
  }).then(doc=>{ window.location="ticket.html?id="+doc.id; });
}
</script>
</body>
</html>
